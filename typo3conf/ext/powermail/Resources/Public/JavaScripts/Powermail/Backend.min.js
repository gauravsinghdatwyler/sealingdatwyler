function PowermailBackend(e){"use strict";this.initialize=function(){a(),t(),o(),l(),n(),s(),d(),r(),c(),f(),p(),m(),u(),h(),v()};var a=function(){e(".powermail_listbe_details_container").hide(),e(".openPowermailDetails").click(function(){var i=e(this),a=i.closest("tr").children(":first").children(":first");a.hasClass("fa")?a.toggleClass("fa-caret-right").toggleClass("fa-caret-down"):a.toggleClass("t3-icon-irre-collapsed").toggleClass("t3-icon-irre-expanded"),i.closest("tr").next().toggleClass("powermail_listbe_details_closed").find(".powermail_listbe_details_container").slideToggle()})},t=function(){e(document).on("click",".unhideMail, .hideMail",function(){var i=e(this),a=i.closest("td").find(".container_module_uri").val(),t=i.closest("td").find(".container_uid").val(),o=i.closest("td").find(".container_table").val(),l=_(i.closest("tr"));w(o,t,l,a)})},o=function(){e(document).on("click",".deleteMail",function(){var i=e(this),a=i.closest("td").find(".container_module_uri").val(),t=i.closest("td").find(".container_uid").val(),o=i.closest("td").find(".container_table").val(),l=i.closest("td").find(".container_label_delete_confirmation").val();confirm(l)&&(C(i.closest("tr")),g(o,t,a))})},l=function(){e(".f3-widget-paginator a").click(function(a){var t=e(this).prop("href"),o=t.split("&");for(i=0;i<o.length;i++)if(-1!==o[i].indexOf("widget"))var l=o[i];if(void 0!=l){var n=l.split("=");n[0]=n[0].replace("%40","@");var s='<input type="hidden" name="'+n[0]+'" value="'+n[1]+'" />';e(".hiddenvalues").append(decodeURI(s)),e("#powermail_module_search").submit()}a.preventDefault()})},n=function(){e("a.sorting").click(function(a){a.preventDefault();var t=e(this).prop("href"),o=t.split("&");for(i=0;i<o.length;i++)if(-1!==o[i].indexOf("sorting"))var l=o[i];if(void 0!=l){var n=l.split("=");n[0]=n[0].replace("%40","@");var s=e('.extended_export_sorting_container[name="'+decodeURI(n[0])+'"]');s.length&&s.remove();var d='<input type="hidden" name="'+n[0]+'" value="'+n[1]+'" />';e(".hiddenvalues").append(decodeURI(d)),e("#powermail_module_search").submit()}})},s=function(){e(".addPowermailSelection").click(function(){x(e(this)),b()})},d=function(){e(".addPowermailSelectionAll").click(function(){e(".addPowermailSelection").each(function(){x(e(this))}),b()})},r=function(){e(".powermailSelectionDelete").click(function(){k()})},c=function(){e(".powermailSelectionHide").click(function(){y(e)})},f=function(){e(".extended_search_title").click(function(){var i=e(this);i.hasClass("powermail-close")?(i.removeClass("powermail-close").addClass("powermail-open").children("span").removeClass("t3-icon-move-down").addClass("t3-icon-move-up"),e("fieldset.extended_search").slideDown("",function(){e(this).children(".powermail_module_search_field_container1").children("div.powermail_module_search_field").fadeTo("slow",1)})):(i.removeClass("powermail-open").addClass("powermail-close").children("span").removeClass("t3-icon-move-up").addClass("t3-icon-move-down"),e("fieldset.extended_search").children(".powermail_module_search_field_container1").children("div.powermail_module_search_field").fadeTo("slow",0,function(){e(this).parent().parent().slideUp()}))}),e("fieldset.extended_search input, fieldset.extended_search select").each(function(){return""!=e(this).val()?(e(".extended_search_title").removeClass("powermail-close").addClass("powermail-open"),void e(".extended_search").removeClass("powermail-close").addClass("powermail-open")):void 0}),e(".powermail_module_search_field_container2 input, .powermail_module_search_field_container2 select").each(function(){return""!=e(this).val()?void e(this).parent().parent().removeClass("powermail-close").addClass("powermail-open"):void 0}),e(".searchAddField span, .searchAddField label").click(function(){e("fieldset.extended_search .powermail-close").slideToggle()})},p=function(){e(".powermail_date").each(function(){var i=e(this),a=!0,t=!0;"date"===i.data("datepicker-settings")?t=!1:"time"===i.data("datepicker-settings")&&(a=!1),i.datetimepicker({format:i.data("datepicker-format"),timepicker:t,datepicker:a,lang:"en",i18n:{en:{months:i.data("datepicker-months").split(","),dayOfWeek:i.data("datepicker-days").split(",")}}})})},m=function(){e(".export_icon_xls, .export_icon_csv").click(function(){e(this).hasClass("export_icon_csv")&&e("#forwardToAction").val("exportCsv"),e(this).hasClass("export_icon_xls")&&e("#forwardToAction").val("exportXls"),e(this).closest("form").submit()}),e(".extended_export_title").click(function(){var i=e(this);i.hasClass("powermail-close")?(i.removeClass("powermail-close").addClass("powermail-open").children("span").removeClass("t3-icon-move-down").addClass("t3-icon-move-up"),i.next().slideDown("",function(){i.next().children("div").children("div").fadeTo("slow",1)})):(i.removeClass("powermail-open").addClass("powermail-close").children("span").removeClass("t3-icon-move-up").addClass("t3-icon-move-down"),i.next().children("div").children("div").fadeTo("slow",0,function(){i.next().slideUp()}))}),e(function(){e(".extended_export_field, .extended_export_field_container").sortable({connectWith:".connected",update:function(i,a){var t=e(this).prop("id");if("export_field_selection"===t){var o=e(this).sortable("toArray").toString();e("#export_fields").val(o)}}}).disableSelection()})},u=function(){e(".openHiddenTable").click(function(){var i=e(this).closest("tr");i.find(".dots").toggle(),i.find(".hiddenConverterTable").toggle()})},h=function(){e(".powermail_listbe_details_dd.powermail_listbe_details_type_password").html("********")},v=function(){var i=e(".powermail_reporting_form_fields_table");i.find("tr:even").addClass("even"),i.find("tr:first").removeClass("even"),i.find("tr").hide(),i.find("tr:first").show(),i.find("th").click(function(){var i=e(this);i.hasClass("powermail-close")?i.removeClass("powermail-close").addClass("powermail-open"):i.removeClass("powermail-open").addClass("powermail-close"),i.parent().siblings().slideToggle("fast")}),e('*[data-flot-active="1"]').each(function(){for(var i=e(this),a=[],t=M(i.data("flot-data-values"),","),o=M(i.data("flot-data-labels"),","),l=M(i.data("flot-data-colors"),","),n=0;n<t.length;n++){var s={data:t[n],label:o[n],color:l[n]};a.push(s)}e.plot(i,a,{series:{pie:{show:!0,innerRadius:.5,radius:1,opacity:.3,color:"#FF0000",label:{show:!0,radius:1,formatter:L,background:{opacity:.8}},combine:{color:"#999",threshold:.1}}},grid:{hoverable:!0,clickable:!0}}),i.bind("plothover",function(i,a,t){if(t){var o=parseFloat(t.series.percent).toFixed(2);e("#hover").html("<span style='font-weight:bold; color:"+t.series.color+"'>"+t.series.label+" ("+o+"%)</span>")}}),i.bind("plotclick",function(e,i,a){if(a){var t=parseFloat(a.series.percent).toFixed(2);alert(""+a.series.label+": "+t+"%")}})})},_=function(e){var i=e.find(".visibilityButton"),a=1;return i.hasClass("unhideMail")?(i.removeClass("t3-icon-edit-hide").removeClass("unhideMail").removeClass("fa-toggle-on").addClass("t3-icon-edit-unhide").addClass("hideMail").addClass("fa-toggle-off"),e.find(".t3-icon-tcarecords-tx_powermail_domain_model_mails").addClass("transparent")):(i.removeClass("t3-icon-edit-unhide").removeClass("hideMail").removeClass("fa-toggle-off").addClass("t3-icon-edit-hide").addClass("unhideMail").addClass("fa-toggle-on"),e.find(".t3-icon-tcarecords-tx_powermail_domain_model_mails").removeClass("transparent"),a=0),a},w=function(i,a,t,o){var l=o+"&data["+i+"]["+a+"][hidden]="+t+"&redirect="+T3_THIS_LOCATION;e.ajax({url:l})},g=function(i,a,t){var o=t+"&cmd["+i+"]["+a+"][delete]=1&redirect="+T3_THIS_LOCATION;e.ajax({url:o})},C=function(e){e.fadeOut("slow",function(){e.next().remove(),e.remove()})},x=function(e){e.hasClass("fa")?e.toggleClass("fa-plus").toggleClass("fa-minus").closest("tr").toggleClass("selectLine"):e.toggleClass("t3-icon-view-table-expand").toggleClass("t3-icon-view-table-collapse").closest("tr").toggleClass("selectLine")},b=function(){var i=e(".selectLine").length;e(".selectedLineMessage_numbers").html(i),i>0?e(".selectedLineMessage").show():e(".selectedLineMessage").hide()},k=function(){e(".selectLine").each(function(){var i=e(this),a=i.children(":last"),t=a.find(".container_module_uri").val(),o=a.find(".container_uid").val(),l=a.find(".container_table").val();g(l,o,t),C(i),T(i)}),b()},T=function(e){var i=e.find(".addPowermailSelection");x(i)},y=function(){e(".selectLine").each(function(){var i=e(this),a=i.children(":last"),t=a.find(".container_module_uri").val(),o=a.find(".container_uid").val(),l=a.find(".container_table").val();w(l,o,_(i),t),T(i)}),b()},M=function(e,i){if(-1!==e.toString().indexOf(i))var a=e.split(i);else a=[e];return a},L=function(e,i){return'<div class="flotLabel">'+e+"<br/>"+Math.round(i.percent)+"%</div>"};window.PowermailBackend=PowermailBackend}jQuery(document).ready(function(e){var i=new window.PowermailBackend(e);i.initialize()});